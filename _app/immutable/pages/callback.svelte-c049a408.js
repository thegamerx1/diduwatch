import{M,S as W,i as q,s as z,e as _,c as m,a as h,d as c,b as d,g,J as p,E as S,L as U,N as v,t as C,h as D,j as V,k as T,l as E,m as J,O as L,P as j,Q as F}from"../chunks/index-545e3c05.js";import{g as B}from"../chunks/navigation-75a744b1.js";import{U as w,J as y}from"../chunks/login_store-a1904add.js";import{g as Q,a as H,G as K}from"../chunks/api-374feec2.js";import"../chunks/singletons-eca981c1.js";import"../chunks/index-7681234b.js";const X=()=>{const i=M("__svelte__");return{page:{subscribe:i.page.subscribe},navigating:{subscribe:i.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:i.navigating.subscribe}},session:i.session,updated:i.updated}},Y={subscribe(i){return X().page.subscribe(i)}};function O(i){this.message=i}O.prototype=new Error,O.prototype.name="InvalidCharacterError";var P=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(i){var t=String(i).replace(/=+$/,"");if(t.length%4==1)throw new O("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,e,n=0,o=0,r="";e=t.charAt(o++);~e&&(s=n%4?64*s+e:e,n++%4)?r+=String.fromCharCode(255&s>>(-2*n&6)):0)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e);return r};function Z(i){var t=i.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(s){return decodeURIComponent(P(s).replace(/(.)/g,function(e,n){var o=n.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}(t)}catch{return P(t)}}function I(i){this.message=i}function $(i,t){if(typeof i!="string")throw new I("Invalid token specified");var s=(t=t||{}).header===!0?0:1;try{return JSON.parse(Z(i.split(".")[s]))}catch(e){throw new I("Invalid token specified: "+e.message)}}I.prototype=new Error,I.prototype.name="InvalidTokenError";function R(i,t,s){const e=i.slice();return e[0]=t[s],e}function ee(i){let t,s;function e(a,l){return a[0]instanceof K?se:re}let n=e(i),o=n(i),r=i[0]instanceof Error&&G(i);return{c(){o.c(),t=T(),r&&r.c(),s=E()},l(a){o.l(a),t=J(a),r&&r.l(a),s=E()},m(a,l){o.m(a,l),g(a,t,l),r&&r.m(a,l),g(a,s,l)},p(a,l){n===(n=e(a))&&o?o.p(a,l):(o.d(1),o=n(a),o&&(o.c(),o.m(t.parentNode,t))),a[0]instanceof Error?r?r.p(a,l):(r=G(a),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(a){o.d(a),a&&c(t),r&&r.d(a),a&&c(s)}}}function te(i){let t,s;return{c(){t=_("button"),s=C("Loading"),this.h()},l(e){t=m(e,"BUTTON",{class:!0});var n=h(t);s=D(n,"Loading"),n.forEach(c),this.h()},h(){d(t,"class","btn btn-primary loading")},m(e,n){g(e,t,n),p(t,s)},p:S,d(e){e&&c(t)}}}function re(i){let t;return{c(){t=C(i[0])},l(s){t=D(s,i[0])},m(s,e){g(s,t,e)},p(s,e){e&1&&V(t,s[0])},d(s){s&&c(t)}}}function se(i){let t,s=i[0].errors,e=[];for(let n=0;n<s.length;n+=1)e[n]=x(R(i,s,n));return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=E()},l(n){for(let o=0;o<e.length;o+=1)e[o].l(n);t=E()},m(n,o){for(let r=0;r<e.length;r+=1)e[r].m(n,o);g(n,t,o)},p(n,o){if(o&1){s=n[0].errors;let r;for(r=0;r<s.length;r+=1){const a=R(n,s,r);e[r]?e[r].p(a,o):(e[r]=x(a),e[r].c(),e[r].m(t.parentNode,t))}for(;r<e.length;r+=1)e[r].d(1);e.length=s.length}},d(n){F(e,n),n&&c(t)}}}function x(i){let t,s,e,n,o=i[0]+"",r,a;return{c(){t=_("div"),s=L("svg"),e=L("path"),n=T(),r=C(o),a=T(),this.h()},l(l){t=m(l,"DIV",{class:!0});var u=h(t);s=j(u,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var b=h(s);e=j(b,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),h(e).forEach(c),b.forEach(c),n=J(u),r=D(u,o),a=J(u),u.forEach(c),this.h()},h(){d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"stroke-width","2"),d(e,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),d(s,"xmlns","http://www.w3.org/2000/svg"),d(s,"class","stroke-current flex-shrink-0 h-6 w-6"),d(s,"fill","none"),d(s,"viewBox","0 0 24 24"),d(t,"class","alert alert-warning")},m(l,u){g(l,t,u),p(t,s),p(s,e),p(t,n),p(t,r),p(t,a)},p(l,u){u&1&&o!==(o=l[0]+"")&&V(r,o)},d(l){l&&c(t)}}}function G(i){let t,s,e,n=i[0].stack+"",o;return{c(){t=_("div"),s=_("pre"),e=_("code"),o=C(n),this.h()},l(r){t=m(r,"DIV",{class:!0});var a=h(t);s=m(a,"PRE",{});var l=h(s);e=m(l,"CODE",{});var u=h(e);o=D(u,n),u.forEach(c),l.forEach(c),a.forEach(c),this.h()},h(){d(t,"class","mockup-code")},m(r,a){g(r,t,a),p(t,s),p(s,e),p(e,o)},p(r,a){a&1&&n!==(n=r[0].stack+"")&&V(o,n)},d(r){r&&c(t)}}}function ne(i){let t,s,e;function n(a,l){return a[0]?ee:te}let o=n(i),r=o(i);return{c(){t=_("div"),s=_("div"),e=_("div"),r.c(),this.h()},l(a){t=m(a,"DIV",{class:!0});var l=h(t);s=m(l,"DIV",{class:!0});var u=h(s);e=m(u,"DIV",{class:!0});var b=h(e);r.l(b),b.forEach(c),u.forEach(c),l.forEach(c),this.h()},h(){d(e,"class","container"),d(s,"class","hero-content text-center"),d(t,"class","hero min-h-screen bg-base-200")},m(a,l){g(a,t,l),p(t,s),p(s,e),r.m(e,null)},p(a,[l]){o===(o=n(a))&&r?r.p(a,l):(r.d(1),r=o(a),r&&(r.c(),r.m(e,null)))},i:S,o:S,d(a){a&&c(t),r.d()}}}function ae(i,t,s){var A;let e,n,o;U(i,y,f=>s(3,e=f)),U(i,w,f=>s(4,n=f)),U(i,Y,f=>s(5,o=f));let r,a,l;{r=(A=new URLSearchParams(o.url.hash.substring(1)).get("access_token"))!=null?A:"";let k=$(r);a=Number(k.sub),a!==NaN?u():B("/")}async function u(){try{let f=await Q(r,a),k=await H(r,f.id);v(w,n.user=f,n),v(w,n.list=k,n),v(w,n.favourites=k.filter(N=>N.isFav).map(N=>N.id),n),b()}catch(f){s(0,l=f)}}function b(){v(y,e.token=r,e),v(y,e.userid=a,e),v(y,e.valid=!0,e),B("/dash")}return[l]}class fe extends W{constructor(t){super(),q(this,t,ae,ne,z,{})}}export{fe as default};
