import{M as W,S as q,i as z,s as F,e as _,c as m,a as h,d as c,b as d,g,J as p,E as S,L as U,N as v,t as C,h as D,j as V,k as T,l as E,m as J,O as L,P as j,Q}from"../chunks/index-545e3c05.js";import{g as B}from"../chunks/navigation-75a744b1.js";import{b as P}from"../chunks/paths-b9644fda.js";import{U as w,J as y}from"../chunks/login_store-a1904add.js";import{g as H,a as K,G as X}from"../chunks/api-374feec2.js";import"../chunks/singletons-eca981c1.js";import"../chunks/index-7681234b.js";const Y=()=>{const i=W("__svelte__");return{page:{subscribe:i.page.subscribe},navigating:{subscribe:i.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:i.navigating.subscribe}},session:i.session,updated:i.updated}},Z={subscribe(i){return Y().page.subscribe(i)}};function O(i){this.message=i}O.prototype=new Error,O.prototype.name="InvalidCharacterError";var R=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(i){var t=String(i).replace(/=+$/,"");if(t.length%4==1)throw new O("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,e,a=0,o=0,r="";e=t.charAt(o++);~e&&(s=a%4?64*s+e:e,a++%4)?r+=String.fromCharCode(255&s>>(-2*a&6)):0)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e);return r};function $(i){var t=i.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(s){return decodeURIComponent(R(s).replace(/(.)/g,function(e,a){var o=a.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}(t)}catch{return R(t)}}function I(i){this.message=i}function ee(i,t){if(typeof i!="string")throw new I("Invalid token specified");var s=(t=t||{}).header===!0?0:1;try{return JSON.parse($(i.split(".")[s]))}catch(e){throw new I("Invalid token specified: "+e.message)}}I.prototype=new Error,I.prototype.name="InvalidTokenError";function x(i,t,s){const e=i.slice();return e[0]=t[s],e}function te(i){let t,s;function e(n,l){return n[0]instanceof X?ae:se}let a=e(i),o=a(i),r=i[0]instanceof Error&&M(i);return{c(){o.c(),t=T(),r&&r.c(),s=E()},l(n){o.l(n),t=J(n),r&&r.l(n),s=E()},m(n,l){o.m(n,l),g(n,t,l),r&&r.m(n,l),g(n,s,l)},p(n,l){a===(a=e(n))&&o?o.p(n,l):(o.d(1),o=a(n),o&&(o.c(),o.m(t.parentNode,t))),n[0]instanceof Error?r?r.p(n,l):(r=M(n),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(n){o.d(n),n&&c(t),r&&r.d(n),n&&c(s)}}}function re(i){let t,s;return{c(){t=_("button"),s=C("Loading"),this.h()},l(e){t=m(e,"BUTTON",{class:!0});var a=h(t);s=D(a,"Loading"),a.forEach(c),this.h()},h(){d(t,"class","btn btn-primary loading")},m(e,a){g(e,t,a),p(t,s)},p:S,d(e){e&&c(t)}}}function se(i){let t;return{c(){t=C(i[0])},l(s){t=D(s,i[0])},m(s,e){g(s,t,e)},p(s,e){e&1&&V(t,s[0])},d(s){s&&c(t)}}}function ae(i){let t,s=i[0].errors,e=[];for(let a=0;a<s.length;a+=1)e[a]=G(x(i,s,a));return{c(){for(let a=0;a<e.length;a+=1)e[a].c();t=E()},l(a){for(let o=0;o<e.length;o+=1)e[o].l(a);t=E()},m(a,o){for(let r=0;r<e.length;r+=1)e[r].m(a,o);g(a,t,o)},p(a,o){if(o&1){s=a[0].errors;let r;for(r=0;r<s.length;r+=1){const n=x(a,s,r);e[r]?e[r].p(n,o):(e[r]=G(n),e[r].c(),e[r].m(t.parentNode,t))}for(;r<e.length;r+=1)e[r].d(1);e.length=s.length}},d(a){Q(e,a),a&&c(t)}}}function G(i){let t,s,e,a,o=i[0]+"",r,n;return{c(){t=_("div"),s=L("svg"),e=L("path"),a=T(),r=C(o),n=T(),this.h()},l(l){t=m(l,"DIV",{class:!0});var u=h(t);s=j(u,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var b=h(s);e=j(b,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),h(e).forEach(c),b.forEach(c),a=J(u),r=D(u,o),n=J(u),u.forEach(c),this.h()},h(){d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"stroke-width","2"),d(e,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),d(s,"xmlns","http://www.w3.org/2000/svg"),d(s,"class","stroke-current flex-shrink-0 h-6 w-6"),d(s,"fill","none"),d(s,"viewBox","0 0 24 24"),d(t,"class","alert alert-warning")},m(l,u){g(l,t,u),p(t,s),p(s,e),p(t,a),p(t,r),p(t,n)},p(l,u){u&1&&o!==(o=l[0]+"")&&V(r,o)},d(l){l&&c(t)}}}function M(i){let t,s,e,a=i[0].stack+"",o;return{c(){t=_("div"),s=_("pre"),e=_("code"),o=C(a),this.h()},l(r){t=m(r,"DIV",{class:!0});var n=h(t);s=m(n,"PRE",{});var l=h(s);e=m(l,"CODE",{});var u=h(e);o=D(u,a),u.forEach(c),l.forEach(c),n.forEach(c),this.h()},h(){d(t,"class","mockup-code")},m(r,n){g(r,t,n),p(t,s),p(s,e),p(e,o)},p(r,n){n&1&&a!==(a=r[0].stack+"")&&V(o,a)},d(r){r&&c(t)}}}function ne(i){let t,s,e;function a(n,l){return n[0]?te:re}let o=a(i),r=o(i);return{c(){t=_("div"),s=_("div"),e=_("div"),r.c(),this.h()},l(n){t=m(n,"DIV",{class:!0});var l=h(t);s=m(l,"DIV",{class:!0});var u=h(s);e=m(u,"DIV",{class:!0});var b=h(e);r.l(b),b.forEach(c),u.forEach(c),l.forEach(c),this.h()},h(){d(e,"class","container"),d(s,"class","hero-content text-center"),d(t,"class","hero min-h-screen bg-base-200")},m(n,l){g(n,t,l),p(t,s),p(s,e),r.m(e,null)},p(n,[l]){o===(o=a(n))&&r?r.p(n,l):(r.d(1),r=o(n),r&&(r.c(),r.m(e,null)))},i:S,o:S,d(n){n&&c(t),r.d()}}}function oe(i,t,s){var A;let e,a,o;U(i,y,f=>s(3,e=f)),U(i,w,f=>s(4,a=f)),U(i,Z,f=>s(5,o=f));let r,n,l;{r=(A=new URLSearchParams(o.url.hash.substring(1)).get("access_token"))!=null?A:"";let k=ee(r);n=Number(k.sub),n!==NaN?u():B(`${P}/`)}async function u(){try{let f=await H(r,n),k=await K(r,f.id);v(w,a.user=f,a),v(w,a.list=k,a),v(w,a.favourites=k.filter(N=>N.isFav).map(N=>N.id),a),b()}catch(f){s(0,l=f)}}function b(){v(y,e.token=r,e),v(y,e.userid=n,e),v(y,e.valid=!0,e),B(`${P}/dash`)}return[l]}class he extends q{constructor(t){super(),z(this,t,oe,ne,F,{})}}export{he as default};
